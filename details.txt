neon db doctors table.

-- Enable UUID generation
CREATE EXTENSION IF NOT EXISTS pgcrypto;

CREATE TABLE IF NOT EXISTS doctors (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),

  -- department will be added later (nullable now)
  department_id UUID NULL,

  slug VARCHAR(255) UNIQUE NOT NULL,

  name_en VARCHAR(255) NOT NULL,
  name_hi VARCHAR(255),
  name_mr VARCHAR(255),

  specialization_en VARCHAR(255),
  specialization_hi VARCHAR(255),
  specialization_mr VARCHAR(255),

  consultation_fee NUMERIC(10,2) NOT NULL DEFAULT 0,

  bio_en TEXT,
  bio_hi TEXT,
  bio_mr TEXT,

  image_url TEXT,
  is_active BOOLEAN DEFAULT TRUE,

  created_at TIMESTAMPTZ DEFAULT NOW(),
  updated_at TIMESTAMPTZ DEFAULT NOW()
);

CREATE INDEX IF NOT EXISTS doctors_is_active_idx ON doctors(is_active);
CREATE INDEX IF NOT EXISTS doctors_slug_idx ON doctors(slug);
  

  ---------------------------------------------


  run this when department table is created in future 

  ALTER TABLE doctors
ADD CONSTRAINT doctors_department_fk
FOREIGN KEY (department_id) REFERENCES departments(id);


---------------------------------------------------------



step 1 
CREATE EXTENSION IF NOT EXISTS pgcrypto;

CREATE TABLE IF NOT EXISTS doctors (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  department_id UUID NULL,
  slug VARCHAR(255) UNIQUE NOT NULL,
  name_en VARCHAR(255) NOT NULL,
  name_hi VARCHAR(255),
  name_mr VARCHAR(255),
  specialization_en VARCHAR(255),
  specialization_hi VARCHAR(255),
  specialization_mr VARCHAR(255),
  consultation_fee NUMERIC(10,2) NOT NULL DEFAULT 0,
  bio_en TEXT,
  bio_hi TEXT,
  bio_mr TEXT,
  image_url TEXT,
  is_active BOOLEAN DEFAULT TRUE,
  created_at TIMESTAMPTZ DEFAULT NOW(),
  updated_at TIMESTAMPTZ DEFAULT NOW()
);

CREATE INDEX IF NOT EXISTS doctors_is_active_idx ON doctors(is_active);
CREATE INDEX IF NOT EXISTS doctors_slug_idx ON doctors(slug);


Step 2 — Add your Neon connection string

In Neon dashboard → Connection string → copy the URL.

Create a file in project root:

.env.local
DATABASE_URL="YOUR_NEON_CONNECTION_STRING_HERE"


✅ Restart server after adding env:


step 3
Create a DB helper (one file)
lib/db.js
import { neon } from "@neondatabase/serverless";

if (!process.env.DATABASE_URL) {
  throw new Error("DATABASE_URL is missing in .env.local");
}

export const sql = neon(process.env.DATABASE_URL);


Step 4

Create Doctor queries (fetch functions)
lib/queries/doctors.js
import { sql } from "@/lib/db";

export async function getDoctors({ activeOnly = true } = {}) {
  const where = activeOnly ? sql`WHERE is_active = TRUE` : sql``;

  const rows = await sql`
    SELECT
      id, slug,
      name_en, name_hi, name_mr,
      specialization_en, specialization_hi, specialization_mr,
      consultation_fee, image_url, is_active
    FROM doctors
    ${where}
    ORDER BY name_en ASC
  `;

  return rows;
}

export async function getDoctorBySlug(slug) {
  const clean = String(slug || "").trim().toLowerCase();

  const rows = await sql`
    SELECT *
    FROM doctors
    WHERE LOWER(slug) = ${clean}
    LIMIT 1
  `;

  return rows[0] || null;
}


Step 5 — Insert (populate) doctors into Neon

Run this SQL in Neon:

INSERT INTO doctors
(slug, name_en, name_hi, name_mr, specialization_en, specialization_hi, specialization_mr, consultation_fee, bio_en, bio_hi, bio_mr, image_url, is_active)
VALUES
(
  'dr-prashant-rahate',
  'Dr. Prashant Rahate',
  'डॉ. प्रशांत रहाटे',
  'डॉ. प्रशांत रहाटे',
  'Gastroenterology',
  'गॅस्ट्रोएन्टेरोलॉजी',
  'गॅस्ट्रोएन्टेरोलॉजी',
  500,
  'Dr. Prashant Rahate is a senior specialist with extensive experience in digestive health. He focuses on accurate diagnosis and patient-first treatment.\n\nHe believes in compassionate care, clear communication, and modern technology to support quick recovery.',
  'डॉ. प्रशांत रहाटे हे पचनसंस्थेच्या आरोग्यासाठी अनुभवी तज्ज्ञ आहेत. ते अचूक निदान आणि रुग्ण-केंद्रित उपचारांवर भर देतात.\n\nत्यांचा दृष्टिकोन करुणा, स्पष्ट संवाद आणि आधुनिक तंत्रज्ञानावर आधारित आहे.',
  'डॉ. प्रशांत रहाटे हे पचनसंस्थेच्या आरोग्यासाठी अनुभवी तज्ज्ञ आहेत. ते अचूक निदान आणि रुग्ण-केंद्रित उपचारांवर भर देतात.\n\nत्यांचा दृष्टिकोन करुणा, स्पष्ट संवाद आणि आधुनिक तंत्रज्ञानावर आधारित आहे.',
  'https://images.unsplash.com/photo-1537368910025-700350fe46c7?auto=format&fit=crop&w=800&q=80',
  TRUE
);


Add more doctors by copying the row and changing values.

✅ Quick check:

SELECT slug, name_en FROM doctors;

Step 6 — Doctors List Page (App Router)

Create:

app/[lang]/doctors/page.js
import Link from "next/link";
import Image from "next/image";
import { getDoctors } from "@/lib/queries/doctors";

export default async function DoctorsPage({ params }) {
  const { lang } = await params;
  const doctors = await getDoctors();

  const pick = (row, key) => row[`${key}_${lang}`] || row[`${key}_en`];

  return (
    <div className="mx-auto max-w-7xl px-4 sm:px-8 py-10">
      <h1 className="text-3xl sm:text-4xl font-bold text-[#265957]">
        Our Doctors
      </h1>
      <p className="mt-2 text-gray-600">
        Choose a specialist and book your consultation.
      </p>

      <div className="mt-8 grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-4 gap-4 sm:gap-6">
        {doctors.map((d) => (
          <Link
            key={d.id}
            href={`/${lang}/doctors/${d.slug}`}
            className="bg-white rounded-2xl shadow border border-gray-100 hover:shadow-lg transition p-4"
          >
            <div className="relative w-full aspect-[4/5] rounded-xl overflow-hidden bg-gray-100">
              <Image
                src={d.image_url || "/assets/doctor-placeholder.png"}
                alt={pick(d, "name")}
                fill
                className="object-cover"
              />
            </div>

            <h3 className="mt-3 font-semibold text-gray-900 text-sm sm:text-base">
              {pick(d, "name")}
            </h3>

            <p className="text-xs sm:text-sm text-gray-500 mt-1">
              {pick(d, "specialization")}
            </p>

            <p className="text-xs sm:text-sm font-semibold text-[#255C8D] mt-2">
              ₹{Number(d.consultation_fee).toFixed(0)} Consultation Fee
            </p>
          </Link>
        ))}
      </div>
    </div>
  );
}

Step 7 — Doctor Detail Page (by slug)

Create:

app/[lang]/doctors/[slug]/page.js
import Image from "next/image";
import Link from "next/link";
import { notFound } from "next/navigation";
import { getDoctorBySlug } from "@/lib/queries/doctors";

export default async function DoctorDetailPage({ params }) {
  const { lang, slug } = await params;

  const doctor = await getDoctorBySlug(slug);
  if (!doctor) return notFound();

  const pick = (row, key) => row[`${key}_${lang}`] || row[`${key}_en`];

  return (
    <div className="mx-auto max-w-5xl px-4 sm:px-8 py-10">
      <div className="flex flex-col md:flex-row gap-8">
        <div className="relative w-full md:w-[320px] aspect-[4/5] rounded-2xl overflow-hidden bg-gray-100">
          <Image
            src={doctor.image_url || "/assets/doctor-placeholder.png"}
            alt={pick(doctor, "name")}
            fill
            className="object-cover"
          />
        </div>

        <div className="flex-1">
          <h1 className="text-3xl sm:text-4xl font-bold text-[#265957]">
            {pick(doctor, "name")}
          </h1>

          <p className="mt-2 text-gray-600">
            {pick(doctor, "specialization")}
          </p>

          <p className="mt-4 text-sm sm:text-base text-gray-700 leading-relaxed whitespace-pre-line">
            {doctor[`bio_${lang}`] || doctor.bio_en}
          </p>

          <p className="mt-6 text-lg font-semibold text-[#255C8D]">
            ₹{Number(doctor.consultation_fee).toFixed(0)} Consultation Fee
          </p>

          <div className="mt-6 flex flex-wrap gap-3">
            <Link
              href={`/${lang}/consultation?doctor=${doctor.slug}`}
              className="px-5 py-2.5 rounded-xl bg-[#255C8D] text-white font-semibold hover:opacity-95 transition"
            >
              Book Appointment
            </Link>

            <Link
              href={`/${lang}/doctors`}
              className="px-5 py-2.5 rounded-xl border border-gray-300 font-semibold hover:bg-gray-50 transition"
            >
              Back to Doctors
            </Link>
          </div>
        </div>
      </div>
    </div>
  );
}

Step 8 — IMPORTANT: Allow external image URLs (Next Image)

Because you’re using an image URL, add domains:

next.config.mjs
/** @type {import('next').NextConfig} */
const nextConfig = {
  images: {
    remotePatterns: [
      {
        protocol: "https",
        hostname: "images.unsplash.com",
      },
    ],
  },
};

export default nextConfig;




for newsletter and enquiries

CREATE EXTENSION IF NOT EXISTS pgcrypto;

CREATE TABLE IF NOT EXISTS enquiries (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  name VARCHAR(255) NOT NULL,
  phone VARCHAR(20) NOT NULL,
  wants_email_updates BOOLEAN DEFAULT FALSE,
  created_at TIMESTAMPTZ DEFAULT NOW()
);

CREATE TABLE IF NOT EXISTS newsletter_subscribers (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  name VARCHAR(255),
  phone VARCHAR(20) UNIQUE NOT NULL,
  created_at TIMESTAMPTZ DEFAULT NOW()
);

